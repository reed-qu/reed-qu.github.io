<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>æ™®é€šæœ€å°äºŒä¹˜æ³•</title>
<link href="https://reed-qu.github.io/theme/css/main.css" rel="stylesheet"/>
<link href="https://reed-qu.github.io/feeds/all.atom.xml" rel="alternate" title="[reed@blog ~]# _ Atom Feed" type="application/atom+xml"/>
</head>
<body class="home" id="index">
<header class="body" id="banner">
<h1><a href="https://reed-qu.github.io/">[reed@blog ~]# _ </a></h1>
<nav><ul>
<li class="active"><a href="https://reed-qu.github.io/category/machine-learning.html">machine learning</a></li>
</ul></nav>
</header><!-- /#banner -->
<section class="body" id="content">
<article>
<header>
<h1 class="entry-title">
<a href="https://reed-qu.github.io/pu-tong-zui-xiao-er-cheng-fa.html" rel="bookmark" title="Permalink to æ™®é€šæœ€å°äºŒä¹˜æ³•">æ™®é€šæœ€å°äºŒä¹˜æ³•</a></h1>
</header>
<div class="entry-content">
<footer class="post-info">
<abbr class="published" title="2020-01-21T15:20:30+08:00">
                Published: 2020-01-21
        </abbr>
<address class="vcard author">
                By                         <a class="url fn" href="https://reed-qu.github.io/author/reed.html">reed</a>
</address>
<p>In <a href="https://reed-qu.github.io/category/machine-learning.html">machine learning</a>.</p>
</footer><!-- /.post-info --> <blockquote>
<p>åœ¨ <a href="https://reed-qu.github.io/pi-liang-ti-du-xia-jiang.html"> æ‰¹é‡æ¢¯åº¦ä¸‹é™ </a>ä¸­è®¨è®ºäº†ï¼Œå¦‚ä½•åˆ©ç”¨æ¢¯åº¦ä¸‹é™çš„æ–¹å¼ï¼Œå¦‚ä½•ä¸€æ­¥ä¸€æ­¥å¯»æ‰¾åˆ°æŸå¤±å‡½æ•°çš„æœ€å°å€¼ï¼Œå¾—åˆ°æœ€ä½³æ‹Ÿåˆçš„  <span class="math">\(\theta\)</span>ï¼Œè¿™é‡Œæˆ‘ä»¬ç»§ç»­è®¨è®ºçº¿æ€§æ‹Ÿåˆé—®é¢˜ï¼Œè¿™æ¬¡å°è¯•ç”¨<a href="https://link.zhihu.com/?target=https%3A//zh.wikipedia.org/zh-
hans/%25E6%259C%2580%25E5%25B0%258F%25E4%25BA%258C%25E4%25B9%2598%25E6%25B3%2595"> æœ€å°äºŒä¹˜æ³• </a>ç›´æ¥æ±‚è§£  <span class="math">\(\theta\)</span>ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬ä¸ç”¨ä»å±±é¡¶å¯»æ‰¾æ¢¯åº¦ä¸€æ­¥ä¸€æ­¥çš„å¾€æœ€ä½ç‚¹èµ°ï¼ŒæŸç§æƒ…å†µä¸‹å¯ä»¥ç›´æ¥è®¡ç®—å‡º  <span class="math">\(\theta\)</span></p>
</blockquote>
<h3><strong>æ™®é€šæœ€å°äºŒä¹˜æ³• <em>(Ordinary least squares)</em></strong></h3>
<p><strong>æœ€å°äºŒä¹˜æ³•</strong> ï¼ˆåˆç§° <strong>æœ€å°å¹³æ–¹æ³•</strong>ï¼‰æ˜¯ä¸€ç§æ•°å­¦ä¼˜åŒ–æŠ€æœ¯ã€‚å®ƒé€šè¿‡æœ€å°åŒ–è¯¯å·®çš„å¹³æ–¹å’Œå¯»æ‰¾æ•°æ®çš„æœ€ä½³å‡½æ•°åŒ¹é…ï¼Œåˆ©ç”¨æœ€å°äºŒä¹˜æ³•å¯ä»¥ç®€ä¾¿åœ°æ±‚å¾—æœªçŸ¥çš„æ•°æ®ï¼Œå¹¶ä½¿å¾—è¿™äº›æ±‚å¾—çš„æ•°æ®ä¸å®é™…æ•°æ®ä¹‹é—´è¯¯å·®çš„å¹³æ–¹å’Œä¸ºæœ€å°ï¼Œä¸‹é¢ä¸€æ­¥ä¸€æ­¥æ¨å¯¼ã€‚</p>
<p><strong>Step 1</strong> . æœ€åˆæˆ‘ä»¬æ˜¯æœ‰ä¸€ç»„è®­ç»ƒæ•°æ® <span class="math">\(D = {(x^{(1)}, y^{(1)}), (x^{(2)}, y^{(2)})...(x^{(N)},y^{(N)})}\)</span>  ï¼Œå…¶ä¸­  <span class="math">\(x^{(i)}\in R^n\)</span> æˆ‘ä»¬æƒ³è¦æ‹Ÿåˆçš„æ›²çº¿ä¸º  <span class="math">\(H(\theta) = \theta^TX = \theta_0X_0 + \theta_1X_1 + \cdots +\theta_nX_n\)</span>  ï¼Œè¿™é‡Œ  <span class="math">\(X_0 = 1\)</span></p>
<p><strong>Step 2</strong> . ç°åœ¨æˆ‘ä»¬ç”¨çŸ©é˜µçš„å½¢å¼æ¥è¡¨ç¤º  <span class="math">\(H(\theta)\)</span>  ï¼Œæˆ‘ä»¬æœ‰ <span class="math">\(N\)</span> ä¸ªæ ·æœ¬æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®ç»´åº¦æ˜¯ <span class="math">\(n\)</span> ç»´</p>
<div class="math">$$
\left[
    \begin{array}{c}
        \theta_0X_0^{(1)} + \theta_1X_1^{(1)} + \cdots + \theta_nX_n^{(1)} = y^{(1)}\\
        \theta_0X_0^{(2)} + \theta_1X_1^{(2)} + \cdots + \theta_nX_n^{(2)} = y^{(2)}\\
        \vdots \\
        \theta_0X_0^{(N)} + \theta_1X_1^{(N)}+ \cdots + \theta_nX_n^{(N)} = y^{(N)}
    \end{array}
\right]\\
$$</div>
<p><strong>Step 3</strong> . è¿™é‡ŒæŠŠä¸Šé¢çš„å…¬å¼ç»„åˆæ‹†åˆ†æˆ3éƒ¨åˆ†  <span class="math">\(X\)</span>  æ•°æ®é›†ï¼Œ  <span class="math">\(\theta\)</span> å‚æ•°ï¼Œ  <span class="math">\(Y\)</span>  ç›®æ ‡å€¼</p>
<div class="math">$$
X = 
\left[ 
    \begin{array}{ccc}
        1 &amp; x_1^{(1)} &amp; \cdots &amp; x_n^{(1)}\\
        1 &amp; x_1^{(2)} &amp; \cdots &amp; x_n^{(2)}\\
        \vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
        1 &amp; x_1^{(N)} &amp; \cdots &amp; x_n^{(N)}
    \end{array}
\right]\\
$$</div>
<div class="math">$$
\theta = 
\left[
    \begin{array}{c}
        \theta_1\\
        \theta_2\\
        \vdots\\
        \theta_n
    \end{array}
\right]\\
$$</div>
<div class="math">$$
Y = 
\left[ 
    \begin{array}{c}
    y_1\\
    y_2\\
    \vdots\\
    y_n
    \end{array}
\right]\\
$$</div>
<p>è¿™æ—¶ç­‰å¼å°±å¯ä»¥å†™æˆ  <span class="math">\(X\theta = Y\)</span></p>
<p><strong>Step 4</strong> . æˆ‘ä»¬æƒ³è¦é€šè¿‡è¿™Nä¸ªç­‰å¼æ¥æ±‚è§£  <span class="math">\(\theta\)</span>  ï¼Œå½“ç„¶è¿™é‡Œä¸ä¸€å®šä¼šæœ‰ <span class="math">\(\theta\)</span>  ä¼šä½¿æ‰€æœ‰ç­‰å¼éƒ½æˆç«‹ï¼Œè¿™æ—¶å€™å°±è¿˜æ˜¯éœ€è¦ä¸€ä¸ªæŸå¤±å‡½æ•°æ¥åˆ¤æ–­å–  <span class="math">\(\theta\)</span> çš„æ—¶å€™ï¼Œè¯¯å·®æ˜¯å¦ä¸ºæœ€å°ï¼Œè¿™é‡Œå°±å’Œæ¢¯åº¦ä¸‹é™æ˜¯ä¸€ä¸ªæ€è·¯ï¼Œç”¨è¯¯å·®å¹³æ–¹å’Œæ¥ä»£è¡¨æŸå¤±ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯ç”¨çŸ©é˜µçš„å½¢å¼æ¥è¡¨ç¤ºï¼ŒçŸ©é˜µçš„ <strong><em>L-2</em></strong> èŒƒæ•°å³è¡¨ç¤ºè¯¯å·®å¹³æ–¹å’Œ</p>
<div class="math">$$
CostFunction = J(\theta) = ||X\theta - Y||_2^2\\
$$</div>
<p><strong>Step 5</strong> . è¿™æ—¶å€™å°±ä¸éœ€è¦ç”¨æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•å»ä¸€æ­¥ä¸€æ­¥è®¡ç®—ï¼Œè¿˜æ˜¯å¯ä»¥æ ¹æ®äººç‰©ä¸‹å±±çš„ä¾‹å­æƒ³è±¡ä¸€ä¸‹ï¼Œæ¢¯åº¦ä¸‹é™æ˜¯äººç‰©ä»¥ <span class="math">\(\alpha\)</span>  ä¸ºæ­¥é•¿ï¼Œèµ°ä¸€æ­¥è®¡ç®—ä¸€ä¸‹æ¢¯åº¦å†èµ°ä¸‹ä¸€æ­¥ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬æ›´åƒæ˜¯äººç‰©å¼€äº†å¤©çœ¼ï¼Œä¸€æ¬¡æ€§ä»æ‰€æœ‰çš„æ•°æ®ä¸­æ‰¾åˆ°æœ€ä¼˜è§£  <span class="math">\(\theta\)</span></p>
<p><strong>Step 6</strong> . é¦–å…ˆæ¥å±•å¼€  <span class="math">\(J(\theta)\)</span></p>
<div class="math">$$
\begin{equation}
    \begin{aligned}
        J(\theta) = ||X\theta - Y||_2^2 
        &amp;= (X\theta - Y)^T(X\theta - Y)\\
        &amp; = (\theta^TX^T - Y^T)(X\theta -Y)\\
        &amp;=\theta^TX^TX\theta - \theta^TX^TY - Y^TX\theta + Y^TY\\
        &amp;=\theta^TX^TX\theta - 2\theta^TX^TY + Y^TY
    \end{aligned}
\end{equation}
$$</div>
<p>ä¸Šå¼ <span class="math">\(\theta^TX^TY\)</span>  æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå› ä¸º <span class="math">\(\theta^T \in 1\times (n+1)\)</span> , <span class="math">\(X^T \in (n+1)\times N\)</span> , <span class="math">\(Y
\in N\times1\)</span>ï¼Œæ‰€ä»¥æ ¹æ®çŸ©é˜µä¹˜æ³•çš„ç‰¹ç‚¹ï¼Œè¿™é‡Œä¹˜å‡ºæ¥ä¹‹åä¼šæ˜¯1ä¸ªæ ‡é‡ï¼Œ<span class="math">\(Y^TX\theta\)</span> åŒç†ï¼Œæ‰€ä»¥äºŒè€…å¯ä»¥åˆå¹¶æˆ <span class="math">\(2\theta^TX^TY\)</span></p>
<p><strong>Step 7</strong> . åœ¨æ¢¯åº¦ä¸‹é™ä¸­ï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çš„è®¡ç®—æ¢¯åº¦ï¼Œä¸€ç›´èµ°åˆ°æœ€ä½ç‚¹ä¹Ÿå°±æ˜¯å¯¼æ•°ä¸º0çš„ç‚¹ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¯¹æŸå¤±å‡½æ•°æ±‚å¯¼ï¼Œä»¤å¯¼æ•°=0å³å¯</p>
<div class="math">$$
\begin{equation}
    \begin{aligned}
        \frac{\partial J(\theta)}{\partial \theta}
        &amp;= \frac {\partial (\theta^TX^TX\theta - 2\theta^TX^TY + Y^TY)}{\partial \theta}\\
        &amp;=\frac{\partial(\theta^TX^TX\theta)}{\partial \theta} - 2X^TY + 0
    \end{aligned}
\end{equation}\\
$$</div>
<p>æ­¤æ—¶æ³¨æ„åˆ°  <span class="math">\(X^TX\)</span>  æ˜¯ä¸€ä¸ª  <span class="math">\((n+1)\)</span>  ç»´çš„æ–¹é˜µï¼Œè¿™æ—¶å€™æ ¹æ®å…¬å¼</p>
<div class="math">$$
\frac{\partial (X^TBX)}{\partial X} = (B + B^T) X\\
$$</div>
<p>å¦‚ä¸ŠçŸ©é˜µç›¸å…³çš„å…¬å¼ï¼Œéƒ½å¯ä»¥åœ¨è¿™ä¸ª<a href="https://link.zhihu.com/?target=http%3A//117.128.6.34/cache/www2.imm.dtu.dk/pubdb/views/edoc_download.php/3274/pdf/imm3274.pdf%3Fich_args2%3D466-11132213008203_0b26da0a993385059ef3d90549e99ec6_10001002_9c896128dec5f1d0943b518939a83798_efb0b935aca0c3bc1c9af15cf2a1260c"> The Matrix Cookbook
</a>ä¸­æŸ¥æ‰¾åˆ°ï¼Œæ‰€ä»¥å¯ä»¥æ¨å¯¼å‡º  <span class="math">\(\theta\)</span>  ç”¨ <span class="math">\(X\)</span>  æ•°æ®é›†å’Œ  <span class="math">\(Y\)</span>  ç›®æ ‡é›†æ¥è¡¨ç¤º</p>
<div class="math">$$
\begin{aligned}
    \frac{\partial(\theta^TX^TX\theta)}{\partial \theta} &amp;= (X^TX +X^TX) \theta = 2X^TX\theta\\
    \frac{\partial J(\theta)}{\partial \theta} &amp;= 2X^TX\theta - 2X^TY = 0\\
    \theta &amp;= (X^TX)^{-1}X^TY
\end{aligned}\\
$$</div>
<h3><strong>æ€»ç»“</strong></h3>
<p>è‡³æ­¤å·²ç»è®¡ç®—å‡ºçº¿æ€§å›å½’ä¸­ <span class="math">\(\theta\)</span> çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸å¿…è¦ç”¨æ¢¯åº¦ä¸‹é™çš„æ–¹å¼å»è¿­ä»£æ”¶æ•›åˆ°æœ€å°å€¼ï¼Œå¯ä»¥ç›´æ¥æ ¹æ®å…¬å¼å¾—åˆ° <span class="math">\(\theta\)</span> æ¸…æ™°çš„è§£æè§£ï¼Œä½†æ˜¯æœ€å°äºŒä¹˜æ³•å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰æƒ…å†µï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>
<p>é€šè¿‡å…¬å¼  <span class="math">\(\theta = (X^TX)^{-1}X^TY\)</span>  å‘ç°å¯¹åœ¨æ•°æ®é›†åŸºç¡€ä¸Šåš <strong>é€†è¿ç®—ï¼Œ</strong>è®¡ç®—çŸ©é˜µçš„é€†éœ€è¦å¤§é‡çš„è®¡ç®—ï¼Œè™½ç„¶ç°åœ¨è®¡ç®—æœºèƒ½åŠ›éƒ½å¾ˆå¼ºï¼Œä½†æ˜¯é‚£ä¹Ÿæ¶ä¸ä½ï¼ŒåŠ¨è¾„ä¸Šç™¾ä¸‡çš„æ•°æ®é‡å’Œä¸Šä¸‡çš„ç»´åº¦ï¼Œæ‰€ä»¥é¦–å…ˆ <strong>æ•°æ®é‡è¿‡å¤§</strong>ä¸é€‚åˆç”¨æœ€å°äºŒä¹˜æ³•ï¼Œåè§‚æ¢¯åº¦ä¸‹é™å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜( ä¸€æ­¥ä¸€æ­¥è¿­ä»£å˜› )</p>
</li>
<li>
<p>è¿˜æ˜¯é€†è¿ç®—ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„çŸ©é˜µéƒ½æ˜¯å¯é€†çš„ï¼Œå¦‚æœæ•°æ®é›†ä¸­æœ‰ <strong>å¤šé‡å…±çº¿æ€§</strong> çš„é—®é¢˜( <strong>çŸ©é˜µè¡Œåˆ—å¼=0</strong> )ï¼Œè¿™é‡Œæ±‚é€†å°±è¡Œä¸é€šäº†ï¼Œå³ä¾¿æ˜¯å¯é€†ï¼Œå¤šé‡å…±çº¿æ€§ä¹Ÿä¼šè®©ç»“æœå¾ˆä¸å‡†ç¡®ï¼Œä½†æ˜¯æ¢¯åº¦ä¸‹é™è¿˜æ˜¯å¯ä»¥ä¸€æ­¥ä¸€æ­¥æ”¶æ•›ã€‚å½“ç„¶äº†ä¹Ÿå¯ä»¥é€šè¿‡æ¯”å¦‚é™ç»´ï¼Œæ±‚ä¼ªé€†ï¼ŒæŸå¤±å‡½æ•°åŠ ä¸Šä¸ªæƒ©ç½šé¡¹( åé¢ä¼šè®¨è®º<strong><em>LASSO</em></strong> å’Œ <strong><em>Ridge</em></strong> )ç­‰åŠæ³•å¯¹æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼Œè½¬åŒ–æˆå¯é€†çŸ©é˜µã€‚</p>
</li>
</ul>
<hr/>
<p>ğŸ˜›</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div><!-- /.entry-content -->
</article>
</section>
<section class="body" id="extras">
<div class="blogroll">
<h2>about me</h2>
<ul>
<li><a href="https://github.com/reedwave">github</a></li>
<li><a href="https://www.zhihu.com/people/reedqu">zhihu</a></li>
<li><a href="https://zhuanlan.zhihu.com/c_1098916898112212992">çŸ¥ä¹ä¸“æ </a></li>
</ul>
</div><!-- /.blogroll -->
<div class="social">
<h2>social</h2>
<ul>
<li><a href="https://reed-qu.github.io/feeds/all.atom.xml" rel="alternate" type="application/atom+xml">atom feed</a></li>
</ul>
</div><!-- /.social -->
</section><!-- /#extras -->
<footer class="body" id="contentinfo">
<address class="vcard body" id="about">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
<p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
</footer><!-- /#contentinfo -->
</body>
</html>